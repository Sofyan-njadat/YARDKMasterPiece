@{
    ViewData["Title"] = "Contact us";
}

@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css" rel="stylesheet">
}

<!-- Modal Search Start -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content rounded-0">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body d-flex align-items-center">
                <div class="input-group w-75 mx-auto d-flex">
                    <input type="search" class="form-control p-3" placeholder="Search Here ..."
                           aria-describedby="search-icon-1">
                    <span id="search-icon-1" class="input-group-text p-3"><i class="fa fa-search"></i></span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal Search End -->
<!-- Header Start -->
<div class="container-fluid bg-breadcrumb">
    <div class="container text-center py-5" style="max-width: 900px;">
        <h1 class="text-white display-3 mb-4 wow fadeInDown" data-wow-delay="0.1s">
            Contact Us</h1>
            <ol class="breadcrumb justify-content-center text-white mb-0 wow fadeInDown" data-wow-delay="0.3s">
                <li class="breadcrumb-item"><a href="index.html" class="text-white">Home</a></li>
                <li class="breadcrumb-item active text-secondary">Contact</li>
            </ol>
    </div>
</div>
<!-- Header End -->
<!-- Contact Start -->
<div class="container-fluid contact overflow-hidden py-5">
    <div class="container py-5">
        <div class="row g-5 mb-5">
            <div class="col-lg-6 wow fadeInLeft" data-wow-delay="0.1s">
                <div class="sub-style">
                    <h5 class="sub-title text-primary pe-3">Quick Contact</h5>
                </div>
                <h1 class="display-5 mb-4">Have Questions? Don't Hesitate to Contact Us</h1>
                <div class="d-flex border-bottom mb-4 pb-4">
                    <i class="fas fa-map-marked-alt fa-4x text-primary bg-light p-3 rounded"></i>
                    <div class="ps-3">
                        <h5>Location</h5>
                        <p>Jordan Amman - Mecca St.</p>
                        <p>Syria Damascus - AL Hamra St.</p>
                    </div>
                </div>
                <div class="row g-3">
                    <div class="col-xl-6">
                        <div class="d-flex">
                            <i class="fas fa-tty fa-3x text-primary"></i>
                            <div class="ps-3">
                                <h5 class="mb-3">Quick Contact</h5>
                                <div class="mb-3">
                                    <h6 class="mb-0">Phone:</h6>
                                    <a href="#" class="fs-5 text-primary">+962 797 265-279</a> <br>
                                </div>
                                <div class="mb-3">
                                    <h6 class="mb-0">Email:</h6>
                                    <a href="#" class="fs-5 text-primary">yadrk@info.com</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6">
                        <div class="d-flex">
                            <i class="fas fa-clone fa-3x text-primary"></i>
                            <div class="ps-3">
                                <h5 class="mb-3">Opening Hrs</h5>
                                <div class="mb-3">
                                    <h6 class="mb-0">Sun - Thu:</h6>
                                    <a href="#" class="fs-5 text-primary">09.00 am to 07.00 pm</a>
                                </div>
                                <div class="mb-3">
                                    <h6 class="mb-0">Satday:</h6>
                                    <a href="#" class="fs-5 text-primary">10.00 am to 05.00 pm</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-lg-6 wow fadeInRight" data-wow-delay="0.3">
                <div class="sub-style">
                    <h5 class="sub-title text-primary pe-3">Let's Connect</h5>
                </div>
                <h1 class="display-5 mb-4">Send Your Message</h1>
                <form id="contactForm" method="post" action="@Url.Action("Contact", "Home")" class="needs-validation" novalidate>
                    @Html.AntiForgeryToken()
                    <div class="row g-4">
                        <div class="col-lg-12 col-xl-6">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="name" name="Name" placeholder="Your Name" required minlength="2">
                                <label for="name">
                                    <span class="en-text">Your Name</span>
                                    <span class="ar-text d-none">الاسم</span>
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="invalid-feedback">
                                    <span class="en-text">Please enter your name (minimum 2 characters)</span>
                                    <span class="ar-text d-none">الرجاء إدخال الاسم (حد أدنى حرفين)</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-xl-6">
                            <div class="form-floating">
                                <input type="email" class="form-control" id="email" name="Email" placeholder="Your Email">
                                <label for="email">
                                    <span class="en-text">Your Email (Optional)</span>
                                    <span class="ar-text d-none">البريد الإلكتروني (اختياري)</span>
                                </label>
                                <div class="invalid-feedback">
                                    <span class="en-text">Please enter a valid email address</span>
                                    <span class="ar-text d-none">الرجاء إدخال بريد إلكتروني صحيح</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="subject" name="Subject" placeholder="Subject" required minlength="3">
                                <label for="subject">
                                    <span class="en-text">Subject</span>
                                    <span class="ar-text d-none">الموضوع</span>
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="invalid-feedback">
                                    <span class="en-text">Please enter a subject (minimum 3 characters)</span>
                                    <span class="ar-text d-none">الرجاء إدخال الموضوع (حد أدنى 3 أحرف)</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="form-floating">
                                <textarea class="form-control" placeholder="Leave a message here" id="message" name="Message" style="height: 160px" required minlength="10"></textarea>
                                <label for="message">
                                    <span class="en-text">Message</span>
                                    <span class="ar-text d-none">الرسالة</span>
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="invalid-feedback">
                                    <span class="en-text">Please enter your message (minimum 10 characters)</span>
                                    <span class="ar-text d-none">الرجاء إدخال الرسالة (حد أدنى 10 أحرف)</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary w-100 py-3">
                                <span class="en-text">Send Message</span>
                                <span class="ar-text d-none">إرسال الرسالة</span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- MAP START -->
        <div class="col-12 pt-5 wow zoomIn" data-wow-delay="0.1s">
            <div class="rounded h-100">
                <iframe class="rounded w-100" style="height: 500px;"
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3363.6290938036245!2d35.89154797511157!3d32.5360517962625!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x151c7612bbd1bf93%3A0x9fa01c45ae100805!2sMakka%20Al%20Mukarramah!5e0!3m2!1sen!2sjo!4v1737940448664!5m2!1sen!2sjo"
                        loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
        <!-- MAP END -->
    </div>
</div>
<!-- Contact End -->

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <script>
        $(document).ready(function() {
            // Language switch handling
            function updateLanguage() {
                const isArabic = localStorage.getItem('language') === 'ar';
                $('.en-text').toggleClass('d-none', isArabic);
                $('.ar-text').toggleClass('d-none', !isArabic);
                $('html').attr('dir', isArabic ? 'rtl' : 'ltr');
            }

            // Initial language setup
            updateLanguage();

            // Listen for language changes
            $(document).on('languageChanged', function() {
                updateLanguage();
            });

            // Form validation and submission
            $('#contactForm').on('submit', function(e) {
                e.preventDefault();
                
                const form = this;
                const isArabic = localStorage.getItem('language') === 'ar';

                // التحقق من صحة النموذج
                if (!form.checkValidity()) {
                    e.stopPropagation();
                    $(form).addClass('was-validated');
                    return false;
                }

                // عرض مؤشر التحميل
                const submitBtn = $(form).find('button[type="submit"]');
                const originalBtnText = submitBtn.html();
                submitBtn.prop('disabled', true);
                submitBtn.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> ' + 
                             (isArabic ? 'جاري الإرسال...' : 'Sending...'));

                // إرسال البيانات
                $.ajax({
                    url: form.action,
                    type: 'POST',
                    data: $(form).serialize(),
                    success: function(response) {
                        if (response.success) {
                            // رسالة النجاح
                            Swal.fire({
                                title: isArabic ? 'تم الإرسال بنجاح' : 'Message Sent Successfully',
                                text: isArabic ? 'شكراً لتواصلك معنا. سنقوم بالرد عليك في أقرب وقت ممكن.' : 
                                               'Thank you for contacting us. We will get back to you as soon as possible.',
                                icon: 'success',
                                confirmButtonText: isArabic ? 'حسناً' : 'OK',
                                customClass: {
                                    popup: isArabic ? 'swal2-rtl' : '',
                                    title: isArabic ? 'swal2-arabic-font' : '',
                                    confirmButton: isArabic ? 'swal2-arabic-font' : ''
                                }
                            }).then(() => {
                                // إعادة تعيين النموذج
                                form.reset();
                                $(form).removeClass('was-validated');
                            });
                        } else {
                            // رسالة خطأ
                            Swal.fire({
                                title: isArabic ? 'خطأ' : 'Error',
                                text: response.message || (isArabic ? 'حدث خطأ أثناء إرسال الرسالة. يرجى المحاولة مرة أخرى.' : 
                                                                    'An error occurred while sending the message. Please try again.'),
                                icon: 'error',
                                confirmButtonText: isArabic ? 'حسناً' : 'OK',
                                customClass: {
                                    popup: isArabic ? 'swal2-rtl' : '',
                                    title: isArabic ? 'swal2-arabic-font' : '',
                                    confirmButton: isArabic ? 'swal2-arabic-font' : ''
                                }
                            });
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('Error:', error);
                        // رسالة خطأ الاتصال
                        Swal.fire({
                            title: isArabic ? 'خطأ' : 'Error',
                            text: isArabic ? 'حدث خطأ في الاتصال بالخادم. يرجى المحاولة مرة أخرى.' : 
                                           'Server connection error. Please try again.',
                            icon: 'error',
                            confirmButtonText: isArabic ? 'حسناً' : 'OK',
                            customClass: {
                                popup: isArabic ? 'swal2-rtl' : '',
                                title: isArabic ? 'swal2-arabic-font' : '',
                                confirmButton: isArabic ? 'swal2-arabic-font' : ''
                            }
                        });
                    },
                    complete: function() {
                        // إعادة تفعيل زر الإرسال
                        submitBtn.prop('disabled', false);
                        submitBtn.html(originalBtnText);
                    }
                });

                return false;
            });
        });
    </script>

    <style>
        .swal2-rtl {
            direction: rtl !important;
        }
        .swal2-arabic-font {
            font-family: 'Cairo', sans-serif !important;
        }
        .spinner-border {
            margin-right: 5px;
        }
        [dir="rtl"] .spinner-border {
            margin-right: 0;
            margin-left: 5px;
        }
    </style>
}